# Core build of OpenCascade.js

opencascade.core.js:
  bindings:
    # FoundationClasses
    - module: "TKernel"
    - module: "TKMath"

    # ModelingData
    - module: "TKG2d"
    - module: "TKG3d"
    - module: "TKGeomBase"
    - module: "TKBRep"

    # ModelingAlgorithms
    - module: "TKGeomAlgo"
    - module: "TKTopAlgo"
    - module: "TKShHealing"
    - module: "TKPrim"
    - module: "TKBO"
    - module: "TKMesh"
    - module: "TKBool"

  inputs:
    # FoundationClasses
    - module: "TKernel"
      preBuilt: True
    - module: "TKMath"
      preBuilt: True

    # ModelingData
    - module: "TKG2d"
      preBuilt: True
    - module: "TKG3d"
      preBuilt: True
    - module: "TKGeomBase"
      preBuilt: True
    - module: "TKBRep"
      preBuilt: True

    # ModelingAlgorithms
    - module: "TKGeomAlgo"
      preBuilt: True
    - module: "TKTopAlgo"
      preBuilt: True
    - module: "TKShHealing"
      preBuilt: True
    - module: "TKPrim"
      preBuilt: True
    - module: "TKBO"
      preBuilt: True
    - module: "TKMesh"
      preBuilt: True
    - module: "TKBool"
      preBuilt: True

  emccFlags:
    - -DIGNORE_NO_ATOMICS=1
    - -frtti
    - -fPIC
    - -O3
    - -DHAVE_RAPIDJSON
    - -sEXPORT_ES6=1
    - -sUSE_ES6_IMPORT_META=0
    - -sUSE_FREETYPE=1
    - -sEXTRA_EXPORTED_RUNTIME_METHODS=["FS"]
    - -sMAIN_MODULE=1
    - -sDISABLE_EXCEPTION_CATCHING=1
    - -sAGGRESSIVE_VARIABLE_ELIMINATION=1
    - -sALLOW_MEMORY_GROWTH=1
    - -sMAXIMUM_MEMORY=4GB

opencascade.complexModeling.wasm:
  bindings:
    # - module: "TKHLR" # could be a niche use case
    # - module: "TKXMesh" # possibly not working
    - module: "TKFillet"
    - module: "TKFeat"
    - module: "TKOffset"

  inputs:
    # - module: "TKHLR" # could be a niche use case
    #   preBuilt: False
    # - module: "TKXMesh" # possibly not working
    #   preBuilt: False
    - module: "TKFillet"
      preBuilt: False
    - module: "TKFeat"
      preBuilt: False
    - module: "TKOffset"
      preBuilt: False

  emccFlags:
    - -DIGNORE_NO_ATOMICS=1
    - -frtti
    - -fPIC
    - -O3
    - -DHAVE_RAPIDJSON
    - -sEXPORT_ES6=1
    - -sUSE_ES6_IMPORT_META=0
    - -sSIDE_MODULE=1
    - -sDISABLE_EXCEPTION_CATCHING=1
    - -sAGGRESSIVE_VARIABLE_ELIMINATION=1

opencascade.visualization.wasm:
  bindings:
    # Visualization
    - module: "TKV3d"
    - module: "TKService"
    # - module: "TKOpenGl" # probably not needed
    - module: "TKMeshVS"

  inputs:
    # Visualization
    - module: "TKV3d"
      preBuilt: False
    - module: "TKService"
      preBuilt: False
    # - module: "TKOpenGl" # probably not needed
    #   preBuilt: False
    - module: "TKMeshVS"
      preBuilt: False

  emccFlags:
    - -DIGNORE_NO_ATOMICS=1
    - -frtti
    - -fPIC
    - -O3
    - -DHAVE_RAPIDJSON
    - -sEXPORT_ES6=1
    - -sUSE_ES6_IMPORT_META=0
    - -sSIDE_MODULE=1
    - -sDISABLE_EXCEPTION_CATCHING=1
    - -sAGGRESSIVE_VARIABLE_ELIMINATION=1
